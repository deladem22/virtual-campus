import{R as p,j as e}from"./jsx-runtime-CAOzMBF_.js";import{c as r}from"./clsx-B-dksMZM.js";import{d as o}from"./dayjs.min-DReL-Uwu.js";import{u as A}from"./index.esm-eIWaUr6p.js";import{B as h}from"./button-D3-ocrTF.js";import{F,u as L}from"./file-input-AkW8SXRP.js";import{I as i}from"./input-DaKQDKVv.js";import{T}from"./textarea-D9GvzXla.js";import{a as j}from"./time-2AcYv75b.js";import{a as V,b as O}from"./index-BqmKY8Xa.js";const P=()=>[{title:"Add Event ✽ gctu"}];function G(){const{register:t,handleSubmit:g,setValue:c,watch:b,getFieldState:f,formState:N}=A(),[a,v]=p.useState(!0),[d,m]=p.useState(!1),y=V(),u=O();async function k(s){if(s.poster){m(!0);const n=await L(s.poster);s.poster=n,m(!1)}y(JSON.stringify({...s,date:o(s.date).startOf("day").add(s.startTime,"seconds").toDate()}),{method:"post",encType:"application/json",action:"/events"})}function S(s){const n=s.target.files;if(n){const w=n[0];c("poster",w)}}const l=b("poster"),x=f("date",N);return e.jsx("div",{className:"container mx-auto min-h-[60vh]",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:e.jsxs("div",{className:"col-span-1 lg:col-span-3",children:[e.jsx("h1",{className:"text-xl font-bold",children:"New Event"}),e.jsx("p",{className:"text-secondary text-sm",children:"Only fields marked with * are required."}),e.jsx("div",{className:"mt-2",children:e.jsxs("button",{type:"button",onClick:()=>v(!a),className:r("flex items-center gap-1 bg-zinc-200 dark:bg-neutral-800 rounded-full px-2 py-1 text-sm font-medium",{"!bg-blue-600 text-white":!a}),children:[e.jsx("div",{className:r("opacity-60",{"i-lucide-eye-off":a,"i-lucide-eye":!a})}),a?"Hide":"Show"," optional fields"]})}),e.jsxs("form",{className:"mt-2",onSubmit:g(k),children:[e.jsxs("label",{children:["Title*",e.jsx(i,{maxLength:60,...t("title",{required:!0,setValueAs(s){return s.trim()}})})]}),e.jsxs("label",{className:"mt-2 block",children:["Date*",e.jsx(i,{type:"date",...t("date",{required:!0,valueAsDate:!0,validate(s){return o(s).isAfter(o().startOf("day"))||"Date must be in the future"}})}),x.error&&e.jsx("span",{className:"text-xs text-red-600 dark:text-red-400",children:x.error.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsx("div",{className:"col-span-1",children:e.jsxs("label",{children:["Time start*",e.jsx(i,{type:"time",...t("startTime",{required:!0,setValueAs(s){return j(s)}})})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("label",{className:r({hidden:!a}),children:["Time end",e.jsx(i,{type:"time",...t("endTime",{setValueAs(s){return j(s)}})}),e.jsx("div",{className:"text-xs text-secondary",children:'"till you drop" will be used in the absence of this'})]})})]}),e.jsxs("label",{className:r("block mt-2",{hidden:!a}),children:["Short description",e.jsx(i,{maxLength:60,...t("shortDescription")}),e.jsxs("span",{className:"text-xs text-secondary",children:["eg. From the Pinegrove boys"," "]})]}),e.jsxs("label",{className:"block mt-2",children:["Description*",e.jsx(T,{maxLength:512,...t("description",{required:!0,setValueAs(s){return s.trim()}})})]}),e.jsxs("label",{children:["Location*",e.jsx(i,{...t("venue",{required:!0,setValueAs(s){return s.trim()}})})]}),e.jsxs("label",{className:r("mt-2 block",{hidden:!a}),children:["Maps link",e.jsx(i,{type:"url",...t("mapsLink",{setValueAs(s){return s.trim()}})}),e.jsx("span",{className:"text-xs text-secondary",children:"Google maps link preferrably."})]}),e.jsxs("label",{className:r("block mt-2",{hidden:!a}),children:["Event link",e.jsx(i,{type:"url",...t("eventLink",{setValueAs(s){return s.trim()}})}),e.jsx("span",{className:"text-xs text-secondary",children:"Link to registration form, zoom/meet link or website for more details."})]}),l&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:URL.createObjectURL(l),alt:"poster",className:"max-w-[20rem] rounded-lg"})}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs(F,{className:"!w-[8rem]",max:1,accept:"image/*",onChange:S,children:[e.jsx("div",{className:"i-lucide-image-plus opacity-60"}),l?"Replace":"Add"," poster"]}),l&&e.jsxs(h,{type:"button",variant:"neutral",onClick:()=>c("poster",null),children:[e.jsx("div",{className:"i-lucide-x opacity-60"})," Remove poster"]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(h,{disabled:u.state==="submitting"||d,children:u.state==="submitting"||d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"i-svg-spinners-180-ring-with-bg"})," ","Submitting…"]}):e.jsx(e.Fragment,{children:"Submit Event"})})})]})]})})})}export{G as default,P as meta};
