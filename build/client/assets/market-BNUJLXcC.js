import{r as u,R as S,j as e}from"./jsx-runtime-CAOzMBF_.js";import{A as o}from"./anchor-BX46IkJD.js";import{I as k}from"./input-DaKQDKVv.js";import{P as C}from"./product-item-BHXp-zgo.js";import{S as P}from"./select-D6U1yScx.js";import{a as $,u as L}from"./components-BUh_SX-e.js";import{c as R,e as w}from"./index-BqmKY8Xa.js";import"./clsx-B-dksMZM.js";const U=({data:s})=>[{title:`Marketplace | ${s==null?void 0:s.school.shortName} âœ½ gctu`},{name:"description",content:"Looking for something to buy or sell? This is the place."}];function z(){const{categories:s,products:n,sellerProfile:i}=$(),{user:l}=L("root")||{},d=R(),t=w(),m=new URLSearchParams(t.search),p=m.get("q")||"",g=m.get("category")||"all",[c,x]=u.useState(p),[r,f]=u.useState(g);S.useEffect(()=>{const a=new URLSearchParams(t.search),N=a.toString();c?a.set("q",c):a.delete("q"),r&&r!=="all"?a.set("category",r):a.delete("category");const y=`${t.pathname}?${N}`.replace(/\?$/,""),h=`${t.pathname}?${a.toString()}`.replace(/\?$/,"");if(h===y)return;const b=setTimeout(()=>{d(h)},600);return()=>clearTimeout(b)},[t.search,t.pathname,d,c,r]);const j=a=>{x(a.target.value)},v=a=>{f(a.target.value)};return e.jsxs("div",{className:"container min-h-[60vh]",children:[e.jsxs("header",{className:"mb-2",children:[e.jsx("h1",{className:"font-bold text-xl",children:"Marketplace"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{type:"search",placeholder:"Search product",value:c,onChange:j}),e.jsxs(P,{value:r,onChange:v,children:[e.jsx("option",{value:"all",children:"All Categories"}),s.map(a=>e.jsx("option",{value:a.id,children:a.title},a.id))]})]})]}),i&&e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(o,{to:"/market/profile",variant:"neutral",children:"Edit profile"}),e.jsx(o,{to:`/p/${l==null?void 0:l.username}/catalog`,variant:"neutral",children:"View catalog"}),e.jsx(o,{to:"/market/add",children:"Add Product"})]}),!i&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 mb-2",children:e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"p-2 rounded-lg bg-zinc-100 dark:bg-neutral-800 border dark:border-neutral-700",children:[e.jsx("header",{className:"font-bold",children:"Have a product?"}),e.jsx("div",{className:"mb-2 text-secondary",children:"Do you have anything to sell? You're welcome to upload any number of products (used or new) you have."}),l?e.jsx(o,{to:"/market/profile",children:"Create seller profile"}):e.jsx(o,{to:"/login",children:"Log in first"})]})})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:n.map(a=>e.jsx("div",{className:"col-span-1",children:e.jsx(C,{product:a})},a.id))}),n.length===0&&e.jsxs("div",{className:"font-mono text-center text-secondary",children:[e.jsx("div",{className:"i-lucide-land-plot inline-block"})," Nothing here!"]})]})}export{z as default,U as meta};
