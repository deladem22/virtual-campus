import{j as e,R as d}from"./jsx-runtime-CAOzMBF_.js";import{c as u}from"./clsx-B-dksMZM.js";import{p as h}from"./index-DliEd2f6.js";import{u as j}from"./index.esm-eIWaUr6p.js";import{A as g}from"./avatar-CnHNwoiQ.js";import{B as x}from"./button-D3-ocrTF.js";import{M as b}from"./modal-BvqMTZsz.js";import{P as N}from"./post-item-FZu80jFJ.js";import{P as v}from"./post-time-BzanNHiO.js";import{T as y}from"./textarea-D9GvzXla.js";import{U as w}from"./username-DR9y_VJH.js";import{a as P,N as C,u as S,b as k}from"./components-BUh_SX-e.js";import{d as F,u as B}from"./index-BqmKY8Xa.js";import"./file-input-AkW8SXRP.js";import"./tag-select-pFlWs3Bt.js";import"./input-DaKQDKVv.js";import"./dayjs.min-DReL-Uwu.js";const Y=({data:s})=>{var t;return[{title:`@${(t=s==null?void 0:s.user)==null?void 0:t.username} | ${s==null?void 0:s.meta.shortName} âœ½ gctu`}]},E=[{title:"Posts",href:"",icon:"i-lucide-message-circle"},{title:"Communities",href:"communities",icon:"i-lucide-users-round",show:({communities:s})=>s>0},{title:"Catalog",href:"catalog",icon:"i-lucide-shopping-cart",show:({seller:s})=>!!s}];function Z(){const{user:s,posts:t,communities:o,seller:a}=P(),l=F(),r={communities:o,seller:a},c=E.filter(i=>{var n;return((n=i.show)==null?void 0:n.call(i,r))??!0});return e.jsx("main",{className:"container mx-auto min-h-[60vh] mt-2",children:e.jsx("div",{className:"grid lg:grid-cols-3",children:e.jsxs("div",{className:"col-span-1 lg:col-span-2",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(g,{name:s.username}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono font-medium",children:e.jsx(w,{user:s,showVerfied:!0})}),e.jsxs("div",{className:"text-secondary text-sm font-medium",children:["Joined ",e.jsx(v,{time:s.createdAt})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"text-secondary bg-zinc-200 dark:bg-neutral-800 inline px-1 py-0.5 rounded-lg font-medium text-sm",children:[t.length," discussions"]}),e.jsx(T,{})]}),e.jsx("div",{className:"mt-2 bio",children:h(s.bio||"")})]})]}),e.jsxs("div",{children:[e.jsx("header",{children:e.jsx("ul",{className:"flex gap-2 my-2 ms-10",children:c.map(i=>e.jsx("li",{children:e.jsxs(C,{end:!0,className:({isActive:n})=>u("flex gap-2 items-center text-center font-medium flex-1 px-2 py-1 bg-zinc-100 dark:bg-neutral-800 rounded-lg text-secondary hover:bg-zinc-200 dark:hover:bg-neutral-700 transition-[background] duration-200",{"!bg-blue-600 !text-white":n}),to:i.href,children:[e.jsx("div",{className:u("inline-block opacity-70",i.icon)}),i.title]})},i.href))})}),l||e.jsx(L,{posts:t})]})]})})})}function L({posts:s}){return s.length===0?e.jsxs("div",{className:"p-4 text-secondary",children:[e.jsx("div",{className:"inline-block i-lucide-signpost"})," No posts published yet"]}):s.map((t,o)=>e.jsxs(d.Fragment,{children:[e.jsx(N,{limit:!0,post:t}),o<s.length-1&&e.jsx("hr",{className:"me-2 ms-12 dark:border-neutral-700"})]},t.id))}function T(){const{username:s}=B(),{user:t}=S("root")||{},{register:o,handleSubmit:a,watch:l}=j({defaultValues:{bio:t==null?void 0:t.bio}}),r=k(),[c,i]=d.useState(!1),n=(t==null?void 0:t.username)===s;async function f(p){r.submit(JSON.stringify(p),{method:"PATCH",encType:"application/json",action:`/p/${s}`}),i(!1)}if(d.useEffect(()=>{r.data&&i(!1)},[r.data]),!n)return null;const m=l("bio");return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"flex items-center gap-1 text-secondary bg-zinc-200 dark:bg-neutral-800 inline px-1 py-0.5 rounded-lg font-medium text-sm",onClick:()=>i(!0),children:[e.jsx("div",{className:"i-lucide-pencil"})," Edit bio"]}),e.jsx(b,{className:"w-full max-w-[24rem]",open:c,onClose:()=>i(!1),children:e.jsxs("form",{onSubmit:a(f),children:[e.jsx("header",{className:"px-2 py-1 font-bold",children:"Edit bio"}),e.jsxs("div",{className:"px-2",children:[e.jsx(y,{maxLength:240,...o("bio")}),e.jsxs("div",{className:"text-end text-xs text-secondary",children:[(m==null?void 0:m.length)||0,"/240"]})]}),e.jsxs("footer",{className:"border-t dark:border-neutral-800 flex justify-end p-2 gap-2 mt-2",children:[e.jsx(x,{type:"button",variant:"neutral",onClick:()=>i(!1),children:"Cancel"}),e.jsx(x,{disabled:r.state==="submitting",children:"Save"})]})]})})]})}export{Z as default,Y as meta};
