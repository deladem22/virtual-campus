import{j as e,R as h}from"./jsx-runtime-CAOzMBF_.js";import{d as p}from"./dayjs.min-DReL-Uwu.js";import{A as j}from"./anchor-CpThXzRC.js";import{A as g}from"./avatar-CnHNwoiQ.js";import{B as d}from"./button-D3-ocrTF.js";import{u as c,a as l,b as u}from"./components-B61dXm5I.js";import{u as f}from"./index-B3TG-iMG.js";import{b,P as v}from"./post-item-C5ncU2kd.js";import"./clsx-B-dksMZM.js";import"./post-time-BzanNHiO.js";import"./file-input-AkW8SXRP.js";import"./modal-Yn7LYWtH.js";import"./index-CNXIhnF3.js";import"./tag-select-dLfp8U7r.js";import"./input-DaKQDKVv.js";import"./index.esm-eIWaUr6p.js";import"./textarea-D9GvzXla.js";import"./username-Dv9jz7V0.js";function m(){const{user:s}=c("root")||{},{community:t,membership:n,members:r}=l(),{slug:a}=f(),i=u();async function x(){i.submit("",{action:`/communities/${a}/members`,method:"POST"})}return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"font-bold text-lg leading-none",children:t.name}),e.jsxs("div",{className:"bg-rose-100 dark:bg-rose-900 dark:bg-opacity-20 rounded-lg inline-block text-rose-500 font-medium px-1 text-sm",children:["+",t.handle]}),e.jsx("p",{className:"",children:t.description}),!n&&e.jsxs("div",{className:"border dark:border-neutral-800 rounded-lg p-2 mt-2",children:[e.jsx("header",{className:"font-mono text-xs text-secondary",children:"Join to interact"}),e.jsx("p",{className:"text-sm",children:"To be able to start and participate in conversations in this community, you need to join first."}),e.jsx("div",{className:"mt-2",children:s?e.jsx(d,{variant:"secondary",disabled:i.state==="submitting",onClick:x,children:i.state==="submitting"?e.jsx(e.Fragment,{children:"Joining"}):e.jsx(e.Fragment,{children:"Join community"})}):e.jsx(j,{to:"/login",children:"Login & join"})})]}),s&&n&&e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"text-xs text-secondary",children:["Member since ",p(n.createdAt).format("DD MMM YYYY")]})}),e.jsxs("div",{className:"max-lg:hidden",children:[e.jsxs("div",{className:"flex gap-2 items-center mt-2 font-medium text-secondary text-sm",children:[e.jsx("div",{className:"i-lucide-users-2 inline-block"}),t.members," members"]}),e.jsx("ul",{children:r.map(o=>e.jsx("li",{children:e.jsxs("div",{className:"flex gap-2 py-1 px-2 rounded-lg hover:bg-zinc-100 items-center hover-bg-light",children:[e.jsx(g,{size:22,name:o.user.username}),e.jsxs("div",{children:[o.user.username," ",o.role==="moderator"&&e.jsx("span",{className:"bg-zinc-200 dark:bg-neutral-800 rounded-full px-2 text-sm text-secondary font-medium",children:"MOD"})]})]})},o.userId))})]})]})}function N({community:s}){const{user:t}=c("root")||{},n=u(),r=[];s.status==="pending-approval"&&r.push({title:"Approve",id:"approve"});function a(i){switch(i){case"approve":n.submit(JSON.stringify({action:i}),{encType:"application/json",method:"POST",action:`/communities/${s.handle}/mod`})}}return r.length===0||(t==null?void 0:t.role)!=="moderator"?null:e.jsxs("div",{className:"mb-2 p-1 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("header",{className:"font-mono text-xs text-red-500",children:"community mod"}),e.jsx("div",{className:"flex",children:r.map(i=>e.jsx(d,{className:"text-sm p-1",variant:"neutral",onClick:()=>a(i.id),disabled:n.state==="submitting",children:i.title},i.id))})]})}const B=({data:s})=>s?[{title:`${s.community.name} (+${s.community.handle}) | ${s.school.shortName} âœ½ Virtual-Campus`},{name:"description",content:s.community.description}]:[];function E(){const{community:s,membership:t,posts:n}=l();return e.jsx("div",{className:"container",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 min-h-[60vh] gap-4",children:[e.jsxs("div",{className:"col-span-1 lg:col-span-2",children:[e.jsx(N,{community:s}),e.jsx("div",{className:"lg:hidden mb-2",children:e.jsx(m,{})}),e.jsx(b,{disabled:!t,dataExtra:{communityId:s.id}}),e.jsx("div",{className:"mt-2",children:n.map((r,a)=>e.jsxs(h.Fragment,{children:[e.jsx(v,{limit:!0,post:r}),a<n.length-1&&e.jsx("hr",{className:"me-2 ms-12 dark:border-neutral-700"})]},r.id))})]}),e.jsx("div",{className:"col-span-1 max-lg:hidden",children:e.jsx(m,{})})]})})}export{E as default,B as meta};
